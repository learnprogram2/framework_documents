## 110-112. 权限管理模块



### 110. 权限管理模块代码骨架





### 111. 不同分层POJO间的数据拷贝-原型, beanCopier-享元

**DO数据转到DTO的时候要拷贝**, 还有DO到BO的转变

```java
// 1. 原型模式 拷贝
class PriorityDO() {
    // 2. 享元模式-可以抽工具类
    private static BeanCopier bc = new BeanCopier();
    // 各种属性
    // clone方法
    protected <T> T clone(Class<T> toClass) {
        T toObject = toClass.newInstance();
        // 从from(自己)拷贝到to: 
        // 1. 可以用 BeanProperties... 之类的反射属性拷贝
        // 2. cglib的动态代理属性拷贝beanCopier-更快
        return to;
    }
}
// 使用
PriorityDTO c = priorityDO.clone(PriorityDTO.class);
```

- **维护一个commonAPI的branch来做这种工具类的创建.** 其他需要就从common里面拉取. 

  可以把beanCopier提取出来做工具类.





### 112. 权限管理模块的CRUD



### 113. 权限删除功能- 基于组合模式+访问者模式

**组合模式:** 将树形数据结构拼接起来, 对每个结点的操作可以直接递归到每一个节点.

**访问者模式:** 对数据结构要执行的操作,  把具体操作封装成访问者, 访问者接收对象, 进去迭代访问就可以了. 

- 访问者模式: 组合模式

```java
// A. 组合模式: 组装树/能够组合树状结构就可以
class PriorityNode {
    private Long parentId;
    private List<PriorityNode> children = new ArrayList<PriorityNode>();
    
    // B.0 访问者模式入口
    public void accept(Visitor visitor){
        visitor.visit(this);
    }
}
// B. 访问者模式
interface Visitor {
    void visit(PriorityNode node);
}
class RemoveAllVisitor implement Visitor {
    public void visit(PriorityNode node) {
        // 1. 迭代到子节点, 保证每个节点都被visited
        for (PriorityNode child : getAllChild(node)) {
            
        }
        // 2. 执行当前节点的visit操作.
        removeChild(node);
    }
    public void removeChild(PriorityNode node) {
        //...
    }
}
// 使用
priorityNode.accept(new RemoveAllVisitor());
```





## 评论模块

### 114. 梳理相关技术问题

1. 定时好评
   - 定时任务调度. 
   - 订单里面添加冗余字段是否有评论. 





### 115. 手动发表评论代码编写



### 116. 自动发表评论代码编写





## 商品中心模块









